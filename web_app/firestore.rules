service cloud.firestore {
  match /databases/{database}/documents {
   match /movies/{movie=**} {
      allow read: if request.auth.uid != null;
      allow write: if request.auth.token.moderator == true;
    }
    match /ratings/{movieid}{
      allow read, write: if request.auth.uid != null;
    }
    match /users/{userid}/ratings/{ratingid} {
      allow read, write: if request.auth.uid == userid;
    }
    match /users/{userid}/movies/{movieid} {
      allow read, write: if request.auth.uid == userid;
    }
  }
}